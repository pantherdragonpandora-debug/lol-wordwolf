# 🌌 ヴォイドに届くは光か闇か - プロジェクト設計書

**プロジェクト名**: ヴォイドに届くは光か闇か (Void Whispers)  
**ゲームタイプ**: LoL/VALORANT特化 連想伝言ゲーム  
**作成日**: 2026-02-15

---

## 📋 ゲーム概要

### コンセプト
プレイヤーが連想ワードを3つずつ伝えていき、最後の人が元のテーマを当てる伝言ゲーム。
途中で連想ワードを修正でき、伝言がどう変化するかを楽しむ。

### 特徴
- **友達部屋プレイ**: 2〜8人で遊べる
- **ソロプレイ**: AIが不足人数を補完
- **LoL/VALORANT特化**: 世界観に合ったテーマ
- **修正機能**: 伝わりにくいワードを途中で修正可能

---

## 🎮 ゲームフロー

### 友達部屋プレイ

```
1. ホストがルーム作成
   ├─ ゲーム種別選択 (LoL / VALORANT)
   ├─ 参加人数設定 (2〜8人)
   └─ テーマ選択方式 (ホスト選択 / ランダム)

2. プレイヤーが参加

3. ゲーム開始
   ├─ 1番目: テーマを見て連想ワード3つ入力
   ├─ 2番目〜N-1番目: 
   │   ├─ 直前の3ワードを見る
   │   ├─ 0〜3個を修正可能
   │   └─ 新しい3ワードを入力
   └─ 最後: 3ワードから元テーマを推測して回答

4. 結果表示
   ├─ 元のテーマ
   ├─ 全員の入力履歴
   ├─ 最終回答
   └─ 正誤判定
```

### ソロプレイ

```
1. ソロプレイ開始
   └─ ゲーム種別選択 (LoL / VALORANT)

2. システムがランダムテーマを提示

3. AIとユーザーが交互にプレイ
   例: AI → ユーザー → AI → AI → ユーザー(回答)

4. 結果表示
```

---

## 🗂️ データ構造

### Firebase Realtime Database

```json
{
  "void_rooms": {
    "room123456": {
      "gameType": "lol",
      "hostName": "Player1",
      "maxPlayers": 4,
      "themeMode": "random",
      "theme": "アッシュ",
      "gameState": "playing",
      "currentTurn": 1,
      "players": {
        "Player1": { "order": 0, "ready": true },
        "Player2": { "order": 1, "ready": true },
        "Player3": { "order": 2, "ready": false },
        "Player4": { "order": 3, "ready": false }
      },
      "turns": {
        "0": {
          "playerName": "Player1",
          "words": ["氷", "弓", "鷹"],
          "modified": [],
          "timestamp": 1234567890
        },
        "1": {
          "playerName": "Player2",
          "words": ["凍結", "射撃", "偵察"],
          "modified": [0, 2],
          "timestamp": 1234567891
        }
      },
      "finalAnswer": "アッシュ",
      "isCorrect": true,
      "createdAt": 1234567890
    }
  }
}
```

---

## 🎨 画面設計

### 1. ゲームモード選択画面（既存に追加）

```
┌─────────────────────────────────┐
│  ゲームモード選択               │
├─────────────────────────────────┤
│  🐺 ワードウルフ                │
│  💖 デマーシアに心を込めて      │
│  🌌 ヴォイドに届くは光か闇か    │← NEW
└─────────────────────────────────┘
```

### 2. ヴォイド - ホーム画面

```
┌─────────────────────────────────┐
│  🌌 ヴォイドに届くは光か闇か    │
├─────────────────────────────────┤
│  [ルームを作成]                 │
│  [ルームに参加]                 │
│  [ソロプレイ]                   │
│  [ルール説明]                   │
└─────────────────────────────────┘
```

### 3. ルーム作成画面

```
┌─────────────────────────────────┐
│  ルーム作成                     │
├─────────────────────────────────┤
│  プレイヤー名: [入力欄]        │
│  ゲーム種別: [LoL] [VALORANT]  │
│  参加人数: [2〜8人スライダー]  │
│  テーマ選択:                    │
│    ○ ランダム                  │
│    ○ ホストが選択              │
│  [作成]                         │
└─────────────────────────────────┘
```

### 4. 待機画面

```
┌─────────────────────────────────┐
│  ルーム: 123456                 │
│  順番  プレイヤー   準備        │
│  1     Player1      ✓           │
│  2     Player2      ✓           │
│  3     Player3      ✓           │
│  4     (待機中)                 │
│                                  │
│  [ゲーム開始] ← ホストのみ     │
└─────────────────────────────────┘
```

### 5. プレイ画面 - 最初のプレイヤー

```
┌─────────────────────────────────┐
│  あなたの番です (1/4)           │
│  テーマ: アッシュ               │
├─────────────────────────────────┤
│  連想する言葉を3つ入力:         │
│  1. [氷_______]                 │
│  2. [弓_______]                 │
│  3. [鷹_______]                 │
│                                  │
│  [送信]                         │
└─────────────────────────────────┘
```

### 6. プレイ画面 - 中間プレイヤー

```
┌─────────────────────────────────┐
│  あなたの番です (2/4)           │
│  前の人が選んだ言葉:            │
│  ┌─────────────────────────┐  │
│  │ ❄️ 氷                      │  │
│  │ 🏹 弓                      │  │
│  │ 🦅 鷹                      │  │
│  └─────────────────────────┘  │
│                                  │
│  伝わりにくい言葉を修正:        │
│  ☐ 氷 → [凍結___]              │
│  ☐ 弓 → [_____]                │
│  ☑ 鷹 → [偵察___]              │
│                                  │
│  新しい3つの言葉:               │
│  1. [凍結____]                  │
│  2. [射撃____]                  │
│  3. [偵察____]                  │
│                                  │
│  [送信]                         │
└─────────────────────────────────┘
```

### 7. プレイ画面 - 最後のプレイヤー

```
┌─────────────────────────────────┐
│  最終回答 (4/4)                 │
│  前の人が選んだ言葉:            │
│  ┌─────────────────────────┐  │
│  │ ❄️ 凍結                    │  │
│  │ 🎯 射撃                    │  │
│  │ 👁️ 偵察                    │  │
│  └─────────────────────────┘  │
│                                  │
│  元のテーマは何だと思いますか？ │
│  [アッシュ_______]              │
│                                  │
│  [回答]                         │
└─────────────────────────────────┘
```

### 8. 結果画面

```
┌─────────────────────────────────┐
│  結果発表                        │
├─────────────────────────────────┤
│  元のテーマ: アッシュ            │
│  最終回答: アッシュ              │
│  正解！ 🎉                      │
├─────────────────────────────────┤
│  言葉の推移:                     │
│                                  │
│  Player1: 氷、弓、鷹            │
│     ↓ (修正: 鷹→偵察)           │
│  Player2: 凍結、射撃、偵察       │
│     ↓ (修正なし)                │
│  Player3: 冷気、遠距離、視界     │
│     ↓                            │
│  Player4: アッシュ ✓            │
│                                  │
│  [もう一度遊ぶ] [ホームに戻る]  │
└─────────────────────────────────┘
```

---

## 🎯 テーマカテゴリー

### League of Legends
- **チャンピオン** (50個)
  - アッシュ、ヤスオ、ラックス、ジンクス、ガレン...
- **アイテム** (30個)
  - インフィニティエッジ、ラバドンデスキャップ...
- **場所・地域** (20個)
  - デマーシア、ノクサス、アイオニア、ヴォイド...
- **概念** (20個)
  - 光、闇、魔法、剣、盾...

### VALORANT
- **エージェント** (50個)
  - Jett、Phoenix、Sage、Reyna、Sova...
- **武器** (20個)
  - ヴァンダル、ファントム、オペレーター...
- **マップ** (10個)
  - バインド、スプリット、アセント...
- **概念** (20個)
  - スモーク、フラッシュ、回復、偵察...

**合計**: 約220テーマ

---

## 🤖 AI実装方針（ソロプレイ用）

### AI の役割
1. **連想ワード生成**: テーマから適切な3ワードを生成
2. **ワード修正**: 前のプレイヤーのワードを理解して修正
3. **テーマ推測**: 最終回答（ただし難易度調整のため、わざと外すことも）

### AI実装オプション

#### オプションA: ルールベース（推奨・実装簡単）
```javascript
// テーマごとに関連ワードを事前定義
const themeDatabase = {
  "アッシュ": {
    keywords: ["氷", "弓", "鷹", "凍結", "射撃", "フレイヨルド"],
    related: ["遠距離", "ADC", "スロー", "クリスタルアロー"]
  }
};

// AIは事前定義から選択+ランダム性
function generateAIWords(theme, difficulty) {
  // 難易度で直接度を調整
  // easy: 直接的なワード
  // hard: 抽象的なワード
}
```

#### オプションB: LLM API連携（高度・コスト高）
```javascript
// OpenAI API / Anthropic Claude を使用
// プロンプト: "アッシュを連想させる3つのワードを生成してください"
// → API呼び出しで動的生成
```

**推奨**: オプションA（ルールベース）
- コスト: 無料
- レスポンス: 即座
- 制御: 容易

---

## 🔧 技術スタック

### フロントエンド
- **HTML/CSS/JavaScript** - 既存と同じ
- **Firebase Realtime Database** - リアルタイム同期

### ゲームロジック
- **`js/void-game.js`** - ゲームクラス
- **`js/void-data.js`** - テーマデータ
- **`js/void-ai.js`** - AI ロジック（ルールベース）

### スタイル
- **`css/void-style.css`** - 専用スタイル
  - テーマカラー: 紫/青のグラデーション（ヴォイドイメージ）

---

## 📏 仕様詳細

### 参加人数
- **最小**: 2人
- **最大**: 8人
- **推奨**: 4〜6人

### ターン数
- プレイヤー数と同じ
- 最初と最後は固定、中間はすべて修正可能

### 修正ルール
- **修正可能数**: 0〜3個（全部修正してもOK）
- **修正表示**: チェックボックスでON/OFF
- **修正履歴**: 結果画面で「氷→凍結」と表示

### 正解判定
- **完全一致**: テーマと回答が完全に一致
- **部分一致**: 許容（例: "アッシュ" と "あっしゅ" は正解）
- **大文字小文字**: 区別しない
- **空白**: 無視

### テーマ選択
- **ランダム**: システムが全テーマからランダム選択
- **ホスト選択**: ホストがリストから選択
  - カテゴリー別に表示
  - 検索機能あり

---

## 🎨 デザインコンセプト

### カラースキーム
```css
--void-primary: #8B5CF6;    /* 紫 */
--void-secondary: #3B82F6;  /* 青 */
--void-dark: #1E1B4B;       /* 深紫 */
--void-glow: #C084FC;       /* 発光紫 */
```

### アニメーション
- ワード表示: フェードイン
- ターン切り替え: スライド
- 正解時: 光のパーティクル

---

## 📱 レスポンシブ対応

- **デスクトップ**: 横並びレイアウト
- **タブレット**: 縦並び
- **スマホ**: 縦スクロール、大きなボタン

---

## 🔒 セキュリティ

### Firebase Security Rules
```json
{
  "rules": {
    "void_rooms": {
      "$roomId": {
        ".read": true,
        ".write": "!data.exists() || data.child('createdAt').val() > (now - 86400000)"
      }
    }
  }
}
```

### 入力検証
- プレイヤー名: 1〜20文字
- ワード: 1〜30文字
- NGワード: 攻撃的表現、差別用語をフィルタ

---

## 🚀 実装ロードマップ

### Phase 1: 基本実装（必須）
1. ✅ 設計書作成
2. ⏳ データ構造実装
3. ⏳ 友達部屋プレイ実装
4. ⏳ ソロプレイ（AI）実装
5. ⏳ UI実装

### Phase 2: 機能拡張（オプション）
6. 統計機能（正解率、人気テーマ）
7. カスタムテーマ作成
8. リプレイ機能
9. ランキング

---

## 📊 想定ファイルリスト

```
js/
  ├─ void-game.js          (5KB) - ゲームロジック
  ├─ void-data.js          (15KB) - テーマデータ
  ├─ void-ai.js            (3KB) - AIロジック
  └─ main.js               (追加コード)

css/
  └─ void-style.css        (5KB) - 専用スタイル

index.html                 (追加HTML)
```

**合計追加サイズ**: 約30KB

---

## ✅ 次のステップ

1. テーマデータファイル作成 (`js/void-data.js`)
2. ゲームロジック実装 (`js/void-game.js`)
3. AI実装 (`js/void-ai.js`)
4. UI実装 (`index.html`, `css/void-style.css`)
5. メイン統合 (`js/main.js`)

---

**作成日**: 2026-02-15  
**ステータス**: 設計完了、実装開始準備完了
