# 気分診断チャンピオン選択 - マルチレーン対応設計 (v5)

**作成日**: 2026-02-20  
**目的**: ニッチなロール×チャンピオンの組み合わせ（MID ガングプランク、SUP リサンドラなど）を候補に挙げるための改善

---

## 🎯 要件

### ユーザーの要望
- **MID ガングプランク**、**SUP リサンドラ** などのニッチな組み合わせも候補に挙がるようにしたい
- 質問数は **12問くらい** が丁度いい（現状維持）
- 質問の **選択肢を増やす** ことで、より細かい診断を実現

### 現在の問題点
1. **単一ロール問題**: チャンピオンが1つの`role`しか持っていない
   - リサンドラ: `role: 'ミッド'` だが、実際にはサポートでも使われる
   - ガングプランク: `role: 'トップ'` だが、ミッドでも使われる
2. **選択肢の少なさ**: 各質問が4選択肢のみで、細かい診断ができない
3. **スコアリングの単純さ**: レーン適性が考慮されていない

---

## 📊 新しいデータ構造

### チャンピオンデータの拡張

**Before（旧構造）**:
```javascript
{ 
  name: 'Lissandra', 
  nameJa: 'リサンドラ', 
  role: 'ミッド',  // ← 単一ロールのみ
  image: 'Lissandra', 
  description: '氷で敵を封じる' 
}
```

**After（新構造）**:
```javascript
{ 
  name: 'Lissandra', 
  nameJa: 'リサンドラ', 
  lanes: [
    { lane: 'mid', priority: 'main', pickRate: 60 },      // メイン: ミッド 60%
    { lane: 'support', priority: 'viable', pickRate: 25 }, // サブ: サポート 25%
    { lane: 'top', priority: 'niche', pickRate: 15 }      // ニッチ: トップ 15%
  ],
  image: 'Lissandra', 
  description: '氷で敵を封じる' 
}
```

### レーン優先度の定義

- **`main`**: メインロール（ピック率 50%以上）
- **`viable`**: 実用的なサブロール（ピック率 20-50%）
- **`niche`**: ニッチなロール（ピック率 5-20%）
- **`off-meta`**: オフメタ（ピック率 5%未満）

### 例

| チャンピオン | メインロール | サブロール | ニッチロール |
|------------|------------|-----------|------------|
| リサンドラ | MID (60%) | SUP (25%) | TOP (15%) |
| ガングプランク | TOP (55%) | MID (30%) | SUP (15%) |
| パンテオン | MID (50%) | SUP (35%) | TOP (15%) |
| スウェイン | SUP (45%) | MID (40%) | TOP (15%) |

---

## 🔢 スコアリングシステムの改善

### レーン適性ボーナス

選択したレーンに応じて、チャンピオンにボーナススコアを付与：

```javascript
// レーン適性ボーナス
const laneBonus = {
  main: 30,      // メインロール: +30点
  viable: 20,    // サブロール: +20点
  niche: 10,     // ニッチロール: +10点
  'off-meta': 5  // オフメタ: +5点
};
```

### 気分スコアとの統合

```javascript
// 最終スコア計算
finalScore = baseScore (100点)
           + moodMatchBonus (0-50点)  // 気分タイプとの相性
           + laneBonus (5-30点)       // レーン適性
           + randomFactor (0-10点)    // ランダム要素
```

### 例：SUP リサンドラの場合

1. **ユーザーがSUPを選択**
2. **リサンドラ（tactical）**:
   - ベーススコア: 100点
   - 気分マッチ: +40点（tacticalタイプと高相性）
   - レーンボーナス: +20点（SUPは`viable`）
   - ランダム: +7点
   - **合計: 167点**

3. **他のミッドメージ（tactical）**:
   - ベーススコア: 100点
   - 気分マッチ: +40点
   - レーンボーナス: +5点（SUPは`off-meta`または対応なし）
   - ランダム: +5点
   - **合計: 150点**

→ リサンドラがSUPで高スコアを獲得！

---

## 📋 質問の選択肢拡張

### 現在の選択肢数
- 各質問: **4選択肢**
- 合計: 12問 × 4選択肢 = **48通りの回答パターン**

### 拡張後の選択肢数
- 各質問: **5-6選択肢**
- 合計: 12問 × 平均5.5選択肢 = **66通りの回答パターン**

### 拡張する質問の例

#### Q2: チームファイトでの役割は？
**Before（4選択肢）**:
1. 敵を倒しまくる
2. 味方を守る
3. CCで敵を妨害
4. 敵のキャリーを狙う

**After（6選択肢）**:
1. 敵を倒しまくる
2. 味方を守る
3. CCで敵を妨害
4. 敵のキャリーを狙う
5. **ポークで削る** ← NEW!
6. **ゾーニングで牽制** ← NEW!

#### Q9: 好きな戦闘距離は？
**Before（4選択肢）**:
1. 接近戦が好き
2. 中距離で立ち回る
3. 遠距離から攻撃
4. 状況に応じて変える

**After（6選択肢）**:
1. 接近戦が好き
2. **近～中距離（ブルーザー）** ← NEW!
3. 中距離で立ち回る
4. **中～遠距離（ポーク）** ← NEW!
5. 遠距離から攻撃
6. 状況に応じて変える

---

## 🎨 実装計画

### Phase 1: データ構造の変更
1. `mood-quiz-data.js` のチャンピオンデータを新構造に変更
2. 全172体のチャンピオンに`lanes`配列を追加
3. 主要なニッチロール組み合わせを定義

### Phase 2: 質問の選択肢拡張
1. Q2, Q4, Q6, Q9, Q11 に選択肢を追加（5-6選択肢に）
2. 各選択肢のポイント配分を調整
3. より細かいプレイスタイルを診断可能に

### Phase 3: スコアリング改善
1. `mood-quiz.js` のスコアリング関数を更新
2. レーン適性ボーナスを追加
3. ニッチロールへの補正を実装

### Phase 4: UI/UX改善
1. 結果画面に「このチャンピオンの得意レーン」を表示
2. ニッチロールの場合は注釈を表示（例: 「MID ガングプランク（ニッチ）」）

### Phase 5: テスト
1. 各レーン選択で正しいチャンピオンが候補に挙がるか確認
2. SUP リサンドラ、MID ガングプランクが適切にランクインするか検証
3. 172体すべてのチャンピオンがバランスよく候補に挙がるか確認

---

## 📝 主要なニッチロール一覧

以下のニッチな組み合わせを優先的にサポート：

| チャンピオン | メイン | ニッチロール |
|------------|--------|------------|
| ガングプランク | TOP | **MID** |
| リサンドラ | MID | **SUP** |
| パンテオン | MID | **SUP**, TOP |
| スウェイン | SUP | **MID** |
| ブランド | SUP | **MID** |
| ザイラ | SUP | **MID** |
| カルマ | SUP | **MID**, TOP |
| ハイマーディンガー | MID | **SUP**, TOP |
| ヴェルコズ | MID | **SUP** |
| セラフィーン | SUP | **MID** |
| モルガナ | SUP | **MID** |
| ルクス | MID | **SUP** |
| ガリオ | MID | **SUP** |
| シェン | TOP | **SUP** |
| ポピー | TOP | **SUP** |
| マオカイ | TOP | **SUP** |
| タム・ケンチ | TOP | **SUP** |
| ジャーヴァンIV | JG | **TOP** |
| カミール | TOP | **JG** |
| シヴァーナ | JG | **TOP** |
| グレイブス | JG | **TOP** |

---

## 🚀 期待される効果

1. **ニッチロール対応**: MID ガングプランク、SUP リサンドラなどが適切に候補に挙がる
2. **診断精度向上**: 選択肢が増えることで、より細かいプレイスタイルを診断
3. **多様性**: 172体すべてのチャンピオンがバランスよく候補に挙がる
4. **リアル反映**: 実際のピック率を反映したレコメンド

---

## 📊 技術的な詳細

### スコアリング関数の疑似コード

```javascript
function calculateChampionScore(champion, userAnswers, selectedLane) {
  let score = 100; // ベーススコア
  
  // 1. 気分タイプとの相性（0-50点）
  const moodMatch = calculateMoodMatch(champion.type, userAnswers);
  score += moodMatch;
  
  // 2. レーン適性ボーナス（5-30点）
  const laneMatch = champion.lanes.find(l => l.lane === selectedLane);
  if (laneMatch) {
    const bonus = laneBonus[laneMatch.priority]; // main:30, viable:20, niche:10, off-meta:5
    score += bonus;
  }
  
  // 3. ランダム要素（0-10点）
  score += Math.floor(Math.random() * 11);
  
  return score;
}
```

---

## ✅ 完了条件

- [ ] 全172体のチャンピオンに`lanes`配列を追加
- [ ] 質問の選択肢を5-6個に拡張（5つの質問）
- [ ] レーン適性ボーナスの実装
- [ ] SUP リサンドラ、MID ガングプランクが候補に挙がることを確認
- [ ] UI に「得意レーン」表示を追加
- [ ] README.md を更新
- [ ] ドキュメント作成

---

次のステップ: チャンピオンデータの変更から実装を開始します。
